#!/usr/bin/env fish

set RUNS_CNT 0x100

set EXPLOIT_PATH "stage_zero/crash.js"
set D8_PATH "../v8/out/x64.debug/d8"

set l_suc_cnt 0

for i in (seq $RUNS_CNT);
	echo "Trying... $l_suc_cnt / $i"
	$D8_PATH --allow-natives-syntax $EXPLOIT_PATH
	if test $status != 0;
		set l_suc_cnt (math $l_suc_cnt + 1);
	end;
end;

set suc_rate (math $l_suc_cnt "*" 100 / $RUNS_CNT)
echo "Success Rate: $suc_rate%" 
